{% extends "layout.html" %}
{% block content %}

<body>
    <script src="/static/jquery-3.4.1.js" type="text/javascript"></script>
    <script src="/static/bootstrap.js" type="text/javascript"></script>
    <script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js"
        integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg=" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>



    <header>
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top bg-primary"
            style="border-bottom-right-radius:2rem !important;border-bottom-left-radius: 2rem !important;">
            <div class="container nav-space">

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
                    aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <img class="mx-auto justify-content-center" src="/static/images/TrashDashLogo.png" width="20%"
                    height="20%" style="margin-top: 2%;margin-bottom: 2%;cursor:pointer;" alt="TrashDash Logo"
                    onclick="window.location.href='/'">

                <div class="collapse navbar-collapse justify-content-end" id="navbarCollapse">
                    <ul class="nav navbar-nav ">
                        <li class="nav-item">
                            <a class="nav-link" href="/dashboard">dashboard</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="/report">report</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/resolve">resolve</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/donate">donate</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/logout">log out</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

    </header>

    <div class="container body-content">

        <div class="row" style="margin-top: 7%;  margin-bottom: 3%;">
            <h1 style="text-align: center;">Welcome to the TrashDash report page!</h1>
            <p style="text-align: center;">Report littered places! (Automatic litter detection from outdoor surveillance
                cameras coming soon!)</p>
        </div>
        <div class="row" style="margin-top: 2%;  margin-bottom: 3%;">
            <div class="col-sm-8">
                <div id="map">
                    <script>
                        var litterIcon = L.icon({
                            iconUrl: "/static/images/Trash.png",
                            iconSize: [38, 38], // size of the icon
                            iconAnchor: [0, 0], // point of the icon which will correspond to marker's location
                            popupAnchor: [20, 0] // point from which the popup should open relative to the iconAnchor
                        });

                        var map = L.map('map').setView([43.7869394036554, -79.18947306043347], 18);
                        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            maxZoom: 19,
                            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                        }).addTo(map);

                        var popup = L.popup();

                        function onMapClick(e) {
                            popup
                                .setLatLng(e.latlng)
                                .setContent("You clicked the map at " + e.latlng.toString())
                                .openOn(map);
                            console.log(e);

                            document.getElementById('long').innerHTML = e.latlng.lng;
                            document.getElementById('lat').innerHTML = e.latlng.lat;
                        }

                        map.on('click', onMapClick);

                        var marker = L.marker([43.7869394036554, -79.18947306043347], { icon: litterIcon }).addTo(map);
                        marker.bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup();
                    </script>
                </div>
            </div>
            <div class="col-sm-4">
                <form method="POST">
                    <h2>Information</h2>
                    <img src="/static/Images/Trash.png" width="15 px" height="15 px" alt="Trash Can">
                    <img src="/static/Images/Trash.png" width="15 px" height="15 px" alt="Trash Can">
                    <img src="/static/Images/Trash.png" width="15 px" height="15 px" alt="Trash Can">
                    <img src="/static/Images/Trash.png" width="15 px" height="15 px" alt="Trash Can">
                    <img src="/static/Images/Trash.png" width="15 px" height="15 px" alt="Trash Can">

                    <br>

                    <label for="title" class="form-label" style="margin-top: 2%">Title</label>
                    <input name="title" type="text" class="form-control" id="title" placeholder="Title" value=""
                        required>
                    <div class="invalid-feedback">
                        Valid number is required.
                    </div>

                    <label for="message" class="form-label" style="margin-top: 2%">Description</label>
                    <input name="message" type="text" class="form-control" id="description" placeholder="Description"
                        value="" required>
                    <div class="invalid-feedback">
                        Valid number is required.
                    </div>

                    <label for="commentTextArea" class="form-label" style="margin-top: 2%">Longitude</label>
                    <div id="long"></div>

                    <label for="commentTextArea" class="form-label" style="margin-top: 2%">Latitude</label>
                    <div id="lat"></div>

                    <button type="submit" class="btn btn-default mt-5" id="sendMessage"
                        style="margin-left: 47%; margin-top: 10%">Submit</button>
                    <input type="hidden" name="_next" value="done.html">
                </form>

            </div>
        </div>
    </div>

    </form>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
        </script>
    <script>
        document.getElementById("sendMessage").onclick = function () {
            window.alert("Ping");
            console.log(urlParams.get('title'));
            axios.post('/location/add', {
                title: 'Fred',
                lastName: 'Flintstone'
            })
                .then(function (response) {
                    console.log(response);
                })
                .catch(function (error) {
                    console.log(error);
                });

            var toastElList = [].slice.call(document.querySelectorAll('.toast'))
            var toastList = toastElList.map(function (toastEl) {
                // Creates an array of toasts (it only initializes them)
                return new bootstrap.Toast(toastEl) // No need for options; use the default options
            });
            toastList.forEach(toast => toast.show()); // this show them
        };

    </script>
    <script type="text/javascript" src="script.js"></script>

</body>

</html>

{% endblock content %}